---
- hosts: nodes
  remote_user: ansible
  become: yes
  vars:
   passwords:
     -        !vault |
          $ANSIBLE_VAULT;1.1;AES256
          31343561333633343836643238383837346135303331336465316237623563623037363261313763
          3335373066643231346439356637373531323439666466650a343230383066356661373236336538
          37656535383564393638323263656361353632373562303464623763326139643162353336306163
          3332303839663463390a623938313839383734643734353962643136636233666163383938643838
          3539
     -        !vault |
          $ANSIBLE_VAULT;1.1;AES256
          63623236613434613936333537663330393565303130626339376634393235623136613336633531
          3533386535633032656434356532343562303939386431300a343032666638626232313162646562
          34323664366531666363313535373861643837386461343530643538653761656132316139323764
          6131636132643934300a656430333536366636313333373836653966303234333664346564613665
          3765
     -        !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33636463326338386164376166636435356466393966333835626364303438663366393137313562
          3933323761386662316463646639346464393635333530650a383835656433613031646639343762
          35643330613836623762313539343061393866306236363531646266313936663832653564326462
          6437636362623938370a386235653838643130346438623433306464616130383261633238386265
          6263

  tasks:
   - name: create users
     user:
        name: '{{ item.name }}'
        state: present
        update_password: on_create
        home: /etc/home/{{ item.name }}
        comment: '{{ item.name }}@example.com'
        password: "{{ item.pass | password_hash }}"
     loop:
      - { name: 'Alice', pass: "{{ passwords[0] }}" }
      - { name: 'Bob', pass: "{{ passwords[1] }}" }
      - { name: 'Carol', pass: "{{ passwords[2] }}" }
...
